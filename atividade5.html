<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Atividade 5</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ciência Colaborativa</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="aulas.html">
    <span class="fas fa-book"></span>
     
    Aulas
  </a>
</li>
<li>
  <a href="materiais.html">
    <span class="fas fa-folder fa-lg"></span>
     
    Materiais
  </a>
</li>
<li>
  <a href="atividades.html">
    <span class="fas fa-chart-bar"></span>
     
    Atividades
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cammcordeiro/ciencia_colab">
    <span class="fab fa-github"></span>
     
    GitHub Repo
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="construir-documento-comentado-com-os-dados-das-bases-abertas-da-atividade-3" class="section level2" number="0.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Construir documento comentado com os dados das bases abertas da atividade 3</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ocorrencias &lt;- read.csv(&quot;data/occ_GBIF-OBIS_par_hepa.csv&quot;, header = TRUE)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # investigar niveis suspeitos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># world &lt;- map_data(&quot;world&quot;)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(world)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # mapa</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_polygon(data = world, aes(x = long, y = lat, group = group)) +</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     coord_fixed() +</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_classic()</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mapa + ocorrencias</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_polygon(data = world, aes(x = long, y = lat, group = group)) +</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_fixed() +</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = ocorrencias, aes(x = decimalLongitude, y = decimalLatitude, color = datasetName)) +</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.title = element_blank()) +</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = &quot;longitude&quot;, y = &quot;latitude&quot;, title = expression(italic(&quot;Paracanthurus hepatus&quot;)))</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_polygon(data = world, aes(x = long, y = lat, group = group)) +</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_fixed() +</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = ocorrencias, aes(x = decimalLongitude, y = decimalLatitude, color = datasetName, size = depth)) +</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   #theme(legend.title = element_blank()) +</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = &quot;longitude&quot;, y = &quot;latitude&quot;, title = expression(italic(&quot;Paracanthurus hepatus&quot;)))</span></span></code></pre></div>
<p>leaflet() %&gt;% addTiles() %&gt;% addMarkers(~decimalLongitude, ~decimalLatitude, popup = ~as.character(datasetName), label = ~as.character(scientificName), clusterOptions = markerClusterOptions())</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = ocorrencias, aes(x = decimalLatitude, y = depth, color = datasetName)) #+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   #theme(legend.title = element_blank()) +</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   #labs(x = &quot;longitude&quot;, y = &quot;latitude&quot;, title = expression(italic(&quot;Paracanthurus hepatus&quot;)))</span></span></code></pre></div>
<div id="datasets-form-bio-oracle" class="section level3" number="0.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Datasets form Bio-Oracle</h3>
<p>layers_BO &lt;- sdmpredictors::list_layers(“Bio-ORACLE”) layers_BO %&gt;% dplyr::select(name, layer_code) %&gt;% filter(name %in% c(“Phosphate concentration (mean at max depth)”, “Nitrate concentration (mean at max depth)”, “Light at bottom (mean at max depth)”, “Iron concentration (mean at max depth)”, “Dissolved oxygen concentration (range at max depth)”, “Dissolved oxygen concentration (minimum at max depth)”, “Dissolved oxygen concentration (mean at max depth)”, “Current velocity (mean at max depth)”, “Sea water temperature (mean at max depth)”, “Primary production (mean at max depth)”, “Sea water salinity (mean at max depth)”, “Silicate concentration (mean at max depth)”, “Sea surface temperature (mean)”))</p>
<p>options(sdmpredictors_datadir = “data/Bio-Oracle/”)</p>
</div>
<div id="download-environmental-data-layers-max.-temperature-min.-salinity-and-min.-nitrates-at-the-sea-bottom" class="section level3" number="0.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Download environmental data layers (Max. Temperature, Min. Salinity and Min. Nitrates at the sea bottom)</h3>
</div>
</div>
<div id="load-from-server" class="section level2" number="0.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> load from server</h2>
</div>
<div id="environment.bottom---load_layerslayercodes-cbo2_curvelmean_bdmax-bo2_dissoxltmax_bdmax-bo2_salinitymean_bdmax-bo2_tempmean_ss-bo_calcite-bo21_tempmean_bdmax" class="section level1" number="1">
<h1 number="6"><span class="header-section-number">6</span> environment.bottom &lt;- load_layers(layercodes = c(“BO2_curvelmean_bdmax”, “BO2_dissoxltmax_bdmax”, “BO2_salinitymean_bdmax”, “BO2_tempmean_ss”, “BO_calcite”, “BO21_tempmean_bdmax”),</h1>
</div>
<div id="equalareafalse-rasterstacktrue" class="section level1" number="2">
<h1 number="7"><span class="header-section-number">7</span> equalarea=FALSE, rasterstack=TRUE)</h1>
<div id="load-local-source" class="section level2" number="2.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> load local source</h2>
<p>environment.bottom &lt;- sdmpredictors::load_layers(c(“BO_bathymean”, “BO2_curvelmean_bdmax”, “BO2_dissoxltmax_bdmax”, “BO2_salinitymean_bdmax”, “BO2_tempmean_ss”, “BO_calcite”, “BO21_tempmean_bdmax”), rasterstack=TRUE)</p>
<div id="sites" class="section level3" number="2.1.1">
<h3 number="7.1.1"><span class="header-section-number">7.1.1</span> SITES</h3>
</div>
<div id="extract-from-rasters" class="section level3" number="2.1.2">
<h3 number="7.1.2"><span class="header-section-number">7.1.2</span> extract from rasters</h3>
</div>
</div>
<div id="section" class="section level2" number="2.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> </h2>
<p>library(sp) my.sites1 &lt;- ocorrencias coordinates(my.sites1)=~decimalLongitude+decimalLatitude SpatialPoints(my.sites1, proj4string = CRS(“+proj=longlat +datum=WGS84”)) points &lt;- SpatialPoints(my.sites1, proj4string=CRS(proj4string(environment.bottom)))</p>
</div>
</div>
<div id="environmental" class="section level1" number="3">
<h1 number="8"><span class="header-section-number">8</span> environmental</h1>
<p>library(raster) store_data1 &lt;- list() for (i in 1:nlayers(environment.bottom)){ store_data1[[i]] = extract(environment.bottom[[i]], points, buffer = 10, fun=mean, # what to value to extract df=F) }</p>
<p>names(store_data1) = names(environment.bottom) marine_data &lt;- bind_cols(ocorrencias, as_tibble(store_data1)) %&gt;% mutate(BO_bathymean = ifelse(BO_bathymean &gt; 0, BO_bathymean*-1, BO_bathymean))</p>
<p>write.csv(marine_data, “data/raster_data_par_hepa.csv”, row.names = FALSE)</p>
<hr />
<div id="workflow-rstudiogithub" class="section level2" number="3.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> Workflow RStudio/Github</h2>
<p>Nesta próxima etapa, vamos continuar a testar novas ferramentas do <code>GitHub</code> e usar comandos para testar novos caminhos sem alterar o repositório principal (<code>branch</code> e <code>merge</code>), além de começar a colaborar com outros usuários (<code>fork</code>, <code>branch</code>, <code>pull request</code> e <code>merge</code>).</p>
<p>PS: este tutorial de Git e GitHub foi adaptado do material criado pelos colegas <a href="https://peld-iloc.github.io/Peld_Iloc_Data_WS/github.html#4_Git">Thiago Silveira</a> e <a href="https://noaa-iea.github.io/r3-train/collaborate.html">Ben Best</a>. <br><br></p>
<div id="intermediário-branch-e-merge" class="section level3" number="3.1.1">
<h3 number="8.1.1"><span class="header-section-number">8.1.1</span> Intermediário: <code>branch</code> e <code>merge</code></h3>
<p>Os comandos <code>branch</code> e <code>merge</code> são muito úteis quando queremos testar diferentes caminhos. Imagine que você quer fazer uma figura e segue uma linha de raciocínio. Depois de se deparar com o resultado final, você percebe que poderia seguir um caminho diferente. Para não perder a primeira versão, que está no ramo <strong>master</strong>, você pode criar um <code>branch</code> , uma diferente abordagem em paralelo. Abaixo um resumo que que será realizado nesta seção:</p>
<table>
<thead>
<tr class="header">
<th align="center">Comando</th>
<th align="center">Ação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>branch</code></td>
<td align="center">Cria um novo “ramo” em seu repositório</td>
</tr>
<tr class="even">
<td align="center"><code>merge</code></td>
<td align="center">Incorporar um ramo criado ao ramo “master”</td>
</tr>
</tbody>
</table>
<p><br><br></p>
<p>O comando git no terminal é <code>git branch</code>. No RStudio você pode criar um novo <code>branch</code> clicando botão como indicadoi abaixo.</p>
<p><img src="figs/git_18.png" style="width:70%"/> <br><br></p>
<p>Depois de criar o novo <code>branch</code> nomeado <strong>Caminho_2</strong>, foram realizadas algumas mudanças no script, fazendo um <code>commit</code> e <code>push</code> neste ramo. Depois disso, será feito um <code>merge</code> incorporando as modificações ao ramo principal <strong>master</strong>. No RStudio é possível somente criar os ramos pela aba <strong>Git</strong>, para fazer o <code>merge</code> você terá que usar linha de comando no <strong>Terminal</strong>. Note que na interface de <code>commit</code>, temos sempre que preencher o campo <strong>commit message</strong>. Abaixo, em verde, são destacadas as mudanças realizadas, vermelho a versão anterior.</p>
<p><img src="figs/git_19.png" style="width:70%"/> <br><br></p>
<p>Para fazer o merge do ramo <strong>Caminho_2</strong>, primeiro você precisa voltar para o ramo <strong>master</strong>. Na aba git do RStudio troque de <strong>Caminho_2</strong> para <strong>master</strong>. Depois disso digite os seguintes comandos no <strong>Terminal</strong>, um de cada vez.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazendo o &quot;merge&quot; de &quot;Caminho_2&quot; ao &quot;master&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>git merge Caminho_2</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazendo o &quot;push&quot; para o repositório</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>git push</span></code></pre></div>
<p>Você verá na aba <strong>Terminal</strong> algo semelhante a figura abaixo.</p>
<p><img src="figs/git_20.png" style="width:100%"/> <br><br></p>
<p>Voltando para o repositório no <strong>Github</strong> podemos visualizar a versão atualizada, mais <strong>upstream</strong> do repositório no ramo <code>master</code>.</p>
<p><img src="figs/git_21.png" style="width:60%"/> <br><br></p>
</div>
<div id="avançado-fork-branch-pull-request-e-merge" class="section level3" number="3.1.2">
<h3 number="8.1.2"><span class="header-section-number">8.1.2</span> Avançado: <code>fork</code>, <code>branch</code>, <code>pull request</code> e <code>merge</code></h3>
<p>Agora que já vimos como fazer as principais ações usando o <strong>Git</strong> e <strong>Github</strong>, a partir deste ponto podemos executar um grupo de comandos que consiste na grande vantagem de se usar o <strong>Github</strong>: a colaboração com controle de versão. Abaixo um resumo dos comandos abordados:</p>
<table>
<thead>
<tr class="header">
<th align="center">Comando</th>
<th align="center">Ação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>fork</code></td>
<td align="center">Copia um diretório do Github</td>
</tr>
<tr class="even">
<td align="center"><code>branch</code></td>
<td align="center">Cria um novo “ramo” em seu repositório</td>
</tr>
<tr class="odd">
<td align="center"><code>pull request</code></td>
<td align="center">Solitação de contribuição</td>
</tr>
<tr class="even">
<td align="center"><code>merge</code></td>
<td align="center">Incorporar um ramo criado ao ramo “master”</td>
</tr>
</tbody>
</table>
<p><br><br></p>
<p>Para colaborar em um repositório você antes de mais nada copiar os arquivos para o seu <strong>Github</strong>. Essa ação é executada com o comando <code>fork</code>. Por exemplo, se dirija ao <a href="https://github.com/peld-iloc/repo_test">respositório de teste</a> e localize no alto da página o botão <code>fork</code>. Depois escolha onde você gostaria de colocar, escolha seu usuário. No canto esquerdo da página mostrará que o repo está em seu usuário também.</p>
<p><img src="figs/git_22.png" style="width:60%"/> <br><br></p>
<p>Agora faça novamente os passos descritos em <strong>4.2 Criando repositório no GitHub (ou REPO)</strong>. Tenha certeza de criar uma nova pasta fora das pastas que você já está trabalhando.</p>
<p>Faça alguma alteração no script, insira uma linha de código, depois faça <code>commit</code> e <code>push</code> . Note que seu repositório será atualizado. Navegue até o <a href="https://github.com/peld-iloc/repo_test">respositório de teste</a> recém clonado e clique em <strong>Contribute</strong>.</p>
<p><img src="figs/git_23.png" style="width:60%"/> <br><br></p>
<p>Aparecerá uma nova página comparando o script antigo com o novo.</p>
<p><img src="figs/git_24.png" style="width:60%"/> <br><br></p>
<p>Clique em <strong>Create pull request</strong>. Com o objetivo de facilitar a colaboração, é eficiente você comentar o objetivo da sua contribuição.</p>
<p><img src="figs/git_25.png" style="width:60%"/> <br><br></p>
<p>Clique novamente no botão <strong>Create pull request</strong> para confirmar sua contribuição. Visualize a página <a href="https://github.com/peld-iloc/repo_test" class="uri">https://github.com/peld-iloc/repo_test</a> e veja como ficou.</p>
<p><img src="figs/git_26.png" style="width:60%"/> <br><br></p>
<p>Agora que você fez um <code>pull request</code>, basta você aguardar o adminstrador do repositório analisar sua sugestão e fazer o <code>merge</code> no ramo <strong>master</strong>.</p>
<p>Esse foi um exercício simples de colaboração usando Git e Github. Para mais informações sobre o workflow usando o Github, acesse <a href="https://guides.github.com/introduction/flow/">Github Guides</a>. Um guia muito útil também é o <a href="https://happygitwithr.com/">Happy Git and Github for the useR</a>.</p>
<hr />
</div>
</div>
</div>

<p>
    <i>Colabore, espalhe a palavra, mas cite as fontes!</i>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
